import{E}from"./exceljs.min-d22432d8.js";import{E as u,h as v}from"./html2canvas.esm-06cbd958.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel-exportTotalInnovatorByOrganization"),x=document.querySelector(".export-pdf-exportTotalInnovatorByOrganization");y&&y.addEventListener("click",async function(){const l=document.getElementById("totalInnovatorChart"),a=window.chartData,e=window.organizationUnitLabel;if(a&&l){const t=new E.Workbook,c=t.addWorksheet("Data"),s=new Set,r=Object.keys(a);r.forEach(m=>{Object.keys(a[m]).forEach(p=>{s.add(parseInt(p))})});const i=Array.from(s).sort(),d=[e,...i];c.addRow(d),r.forEach(m=>{const p=[m];i.forEach(b=>{p.push(a[m][b]||0)}),c.addRow(p)});const n=l.toDataURL("image/png"),o=t.addImage({base64:n.split(",")[1],extension:"png"});c.addImage(o,{tl:{col:0,row:r.length+2},ext:{width:500,height:300}});const h=await t.xlsx.writeBuffer(),g=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(g),w=document.createElement("a");w.href=f,w.download=`total_innovator_by_organization_${e}_${company_name}.xlsx`,w.click(),window.URL.revokeObjectURL(f)}}),x&&x.addEventListener("click",async function(){const l=document.getElementById("totalInnovatorChart"),a=window.chartData,e=window.organizationUnitLabel;if(a&&l){const t=new u;t.setFontSize(18),t.text("Total Innovator per "+e,10,10);const c=new Set,s=Object.keys(a);s.forEach(n=>{Object.keys(a[n]).forEach(o=>{c.add(parseInt(o))})});const r=Array.from(c).sort(),i=10,d=[i+t.getTextWidth(e)+10];r.forEach((n,o)=>{o>0&&d.push(d[o-1]+50)}),t.setFontSize(12),t.text(e,i,20),r.forEach((n,o)=>{t.text(n.toString(),d[o],20)}),s.forEach((n,o)=>{const h=30+o*10;t.text(n,i,h),r.forEach((g,f)=>{t.text((a[n][g]||0).toString(),d[f],h)})}),v(l).then(n=>{const o=n.toDataURL("image/png");t.addImage(o,"PNG",10,30+s.length*10,180,100),t.save(`total_innovator_by_organization_${e}_${company_name}.pdf`)})}})});
