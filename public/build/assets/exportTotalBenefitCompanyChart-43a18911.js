import{E as u}from"./exceljs.min-d22432d8.js";import{E as p,h as w}from"./html2canvas.esm-06cbd958.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const i=document.querySelector(".export-excel-totalBenefitCompanyChart"),s=document.querySelector(".export-pdf-totalBenefitCompanyChart");i&&i.addEventListener("click",async function(){const o=document.getElementById("totalBenefitChart"),a=window.chartData;if(a&&o){const t=new u.Workbook,e=t.addWorksheet("Data"),n=["Perusahaan","Akumulasi Total Finansial Benefit"];e.addRow(n),a.forEach(l=>{e.addRow([l.company_name,l.total_benefit])});const c=o.toDataURL("image/png"),m=t.addImage({base64:c.split(",")[1],extension:"png"});e.addImage(m,{tl:{col:0,row:a.length+2},ext:{width:500,height:300}});const f=await t.xlsx.writeBuffer(),h=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=window.URL.createObjectURL(h),r=document.createElement("a");r.href=d,r.download=`total_benefit_company_${event_name}.xlsx`,r.click(),window.URL.revokeObjectURL(d)}}),s&&s.addEventListener("click",async function(){const o=document.getElementById("totalBenefitChart"),a=window.chartData;if(a&&o){const t=new p;t.setFontSize(18),t.text("Total Benefit Perusahaan",10,10),t.setFontSize(12);let e=20;t.text("Perusahaan",10,e),t.text("Akumulasi Total Finansial Benefit",100,e),a.forEach(n=>{e+=10,t.text(n.company_name,10,e);const c=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n.total_benefit);t.text(c,100,e)}),w(o).then(n=>{const c=n.toDataURL("image/png");t.addImage(c,"PNG",10,e+10,180,100),t.save(`total_benefit_company_${event_name}.pdf`)})}})});
