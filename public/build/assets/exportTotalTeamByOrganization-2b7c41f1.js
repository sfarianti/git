import{E}from"./exceljs.min-d22432d8.js";import{E as x,h as k}from"./html2canvas.esm-06cbd958.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel"),b=document.querySelector(".export-pdf");y&&y.addEventListener("click",async function(){const m=document.getElementById("totalTeamChart"),a=window.chartData,c=window.organizationUnitLabel;if(a&&m){const t=new E.Workbook,r=t.addWorksheet("Data"),s=new Set,n=Object.keys(a);n.forEach(f=>{Object.keys(a[f]).forEach(w=>{s.add(parseInt(w))})});const i=Array.from(s).sort(),d=[c,...i];r.addRow(d),n.forEach(f=>{const w=[f];i.forEach(u=>{w.push(a[f][u]||0)}),r.addRow(w)});const o=m.toDataURL("image/png"),e=t.addImage({base64:o.split(",")[1],extension:"png"});r.addImage(e,{tl:{col:0,row:n.length+2},ext:{width:500,height:300}});const h=await t.xlsx.writeBuffer(),g=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(g),p=document.createElement("a");p.href=l,p.download=`total_team_by_organization_${c}_${company_name}.xlsx`,p.click(),window.URL.revokeObjectURL(l)}}),b&&b.addEventListener("click",async function(){const m=document.getElementById("totalTeamChart"),a=window.chartData,c=window.organizationUnitLabel;if(a&&m){const t=new x;t.setFontSize(18),t.text("Distribusi Ide dan Inovasi",10,10);const r=new Set,s=Object.keys(a);s.forEach(o=>{Object.keys(a[o]).forEach(e=>{r.add(parseInt(e))})});const n=Array.from(r).sort(),i=10,d=[i+t.getTextWidth(c)+10];n.forEach((o,e)=>{e>0&&d.push(d[e-1]+50)}),t.setFontSize(12),t.text(c,i,20),n.forEach((o,e)=>{t.text(o.toString(),d[e],20)}),s.forEach((o,e)=>{const h=30+e*10;t.text(o,i,h),n.forEach((g,l)=>{t.text((a[o][g]||0).toString(),d[l],h)})}),k(m).then(o=>{const e=o.toDataURL("image/png");t.addImage(e,"PNG",10,30+s.length*10,180,100),t.save(`total_team_by_organization_${c}_${company_name}.pdf`)})}})});
