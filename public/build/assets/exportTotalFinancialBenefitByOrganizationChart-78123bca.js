import{E as u}from"./exceljs.min-d22432d8.js";import{E as x,h as k}from"./html2canvas.esm-06cbd958.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel-totalFinancialBenefitByOrganizationChart"),b=document.querySelector(".export-pdf-totalFinancialBenefitByOrganizationChart");y&&y.addEventListener("click",async function(){const l=document.getElementById("totalFinancialChart"),n=window.chartData,o=window.organizationUnitLabel;if(n&&l){const t=new u.Workbook,i=t.addWorksheet("Data"),r=new Set,c=Object.keys(n);c.forEach(m=>{Object.keys(n[m]).forEach(g=>{r.add(parseInt(g))})});const s=Array.from(r).sort(),d=[o,...s];i.addRow(d),c.forEach(m=>{const g=[m];s.forEach(E=>{g.push(n[m][E]||0)}),i.addRow(g)});const e=l.toDataURL("image/png"),a=t.addImage({base64:e.split(",")[1],extension:"png"});i.addImage(a,{tl:{col:0,row:c.length+2},ext:{width:500,height:300}});const f=await t.xlsx.writeBuffer(),w=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=window.URL.createObjectURL(w),p=document.createElement("a");p.href=h,p.download=`total_financial_benefit_by_organization_${o}_${company_name}.xlsx`,p.click(),window.URL.revokeObjectURL(h)}}),b&&b.addEventListener("click",async function(){const l=document.getElementById("totalFinancialChart"),n=window.chartData,o=window.organizationUnitLabel;if(n&&l){const t=new x;t.setFontSize(18),t.text("Total Financial Benefit per "+o,10,10);const i=new Set,r=Object.keys(n);r.forEach(e=>{Object.keys(n[e]).forEach(a=>{i.add(parseInt(a))})});const c=Array.from(i).sort(),s=10,d=[s+t.getTextWidth(o)+10];c.forEach((e,a)=>{a>0&&d.push(d[a-1]+50)}),t.setFontSize(12),t.text(o,s,20),c.forEach((e,a)=>{t.text(e.toString(),d[a],20)}),r.forEach((e,a)=>{const f=30+a*10;t.text(e,s,f),c.forEach((w,h)=>{t.text((n[e][w]||0).toString(),d[h],f)})}),k(l).then(e=>{const a=e.toDataURL("image/png");t.addImage(a,"PNG",10,30+r.length*10,180,100),t.save(`total_financial_benefit_by_organization ${o}_${company_name}.pdf`)})}})});
