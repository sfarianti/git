import{E as p}from"./exceljs.min-d22432d8.js";import{E as u,h as w}from"./html2canvas.esm-06cbd958.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const r=document.querySelector(".export-excel-totalBenefitPotentialCompanyChart"),s=document.querySelector(".export-pdf-totalBenefitPotentialCompanyChart");r&&r.addEventListener("click",async function(){const o=document.getElementById("totalPotentialBenefitChart"),a=window.chartData;if(a&&o){const t=new p.Workbook,e=t.addWorksheet("Data"),n=["Perusahaan","Akumulasi Total Potensial Benefit"];e.addRow(n),a.forEach(d=>{e.addRow([d.company_name,d.total_benefit])});const c=o.toDataURL("image/png"),m=t.addImage({base64:c.split(",")[1],extension:"png"});e.addImage(m,{tl:{col:0,row:a.length+2},ext:{width:500,height:300}});const f=await t.xlsx.writeBuffer(),h=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(h),i=document.createElement("a");i.href=l,i.download=`total_potential_benefit_company_${event_name}.xlsx`,i.click(),window.URL.revokeObjectURL(l)}}),s&&s.addEventListener("click",async function(){const o=document.getElementById("totalBenefitChart"),a=window.chartData;if(a&&o){const t=new u;t.setFontSize(18),t.text("Total Potensial Benefit Perusahaan",10,10),t.setFontSize(12);let e=20;t.text("Perusahaan",10,e),t.text("Akumulasi Total Potensial Benefit",100,e),a.forEach(n=>{e+=10,t.text(n.company_name,10,e);const c=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n.total_benefit);t.text(c,100,e)}),w(o).then(n=>{const c=n.toDataURL("image/png");t.addImage(c,"PNG",10,e+10,180,100),t.save(`total_potential_benefit_company_${event_name}.pdf`)})}})});
