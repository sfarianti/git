import{E as u}from"./exceljs.min-d22432d8.js";import{E as x,h as k}from"./html2canvas.esm-06cbd958.js";import"./_commonjsHelpers-725317a4.js";document.addEventListener("DOMContentLoaded",function(){const y=document.querySelector(".export-excel-totalPotentialBenefitByOrganizationChart"),b=document.querySelector(".export-pdf-totalPotentialBenefitByOrganizationChart");y&&y.addEventListener("click",async function(){const l=document.getElementById("totalPotentialChart"),a=window.chartData,n=window.organizationUnitLabel;if(a&&l){const t=new u.Workbook,r=t.addWorksheet("Data"),i=new Set,c=Object.keys(a);c.forEach(m=>{Object.keys(a[m]).forEach(g=>{i.add(parseInt(g))})});const s=Array.from(i).sort(),d=[n,...s];r.addRow(d),c.forEach(m=>{const g=[m];s.forEach(E=>{g.push(a[m][E]||0)}),r.addRow(g)});const o=l.toDataURL("image/png"),e=t.addImage({base64:o.split(",")[1],extension:"png"});r.addImage(e,{tl:{col:0,row:c.length+2},ext:{width:500,height:300}});const f=await t.xlsx.writeBuffer(),p=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=window.URL.createObjectURL(p),w=document.createElement("a");w.href=h,w.download=`total_potential_benefit_by_organization_${n}_${company_name}.xlsx`,w.click(),window.URL.revokeObjectURL(h)}}),b&&b.addEventListener("click",async function(){const l=document.getElementById("totalPotentialChart"),a=window.chartData,n=window.organizationUnitLabel;if(a&&l){const t=new x;t.setFontSize(18),t.text("Total Potensial Benefit Per "+n,10,10);const r=new Set,i=Object.keys(a);i.forEach(o=>{Object.keys(a[o]).forEach(e=>{r.add(parseInt(e))})});const c=Array.from(r).sort(),s=10,d=[s+t.getTextWidth(n)+10];c.forEach((o,e)=>{e>0&&d.push(d[e-1]+50)}),t.setFontSize(12),t.text(n,s,20),c.forEach((o,e)=>{t.text(o.toString(),d[e],20)}),i.forEach((o,e)=>{const f=30+e*10;t.text(o,s,f),c.forEach((p,h)=>{t.text((a[o][p]||0).toString(),d[h],f)})}),k(l).then(o=>{const e=o.toDataURL("image/png");t.addImage(e,"PNG",10,30+i.length*10,180,100),t.save(`total_potential_benefit_by_organization_${n}_${company_name}.pdf`)})}})});
